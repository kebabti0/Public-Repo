<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>Skill Quadrate – zwei Boards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 1rem;
      background: #f5f5f5;
      color: #222;
    }

    h1 {
      font-size: 1.2rem;
      margin-bottom: 0.8rem;
    }

    h2 {
      font-size: 1rem;
      margin: 1rem 0 0.5rem;
    }

    .rows {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-top: 0.2rem;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .label {
      min-width: 80px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .squares {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }

    .square {
      width: 32px;
      height: 32px;
      border-radius: 3px;
      background: #999;
    }

    .error {
      color: #b00020;
      font-size: 0.8rem;
      margin-top: 0.3rem;
    }

    section {
      background: #fff;
      border-radius: 0.6rem;
      padding: 0.8rem 0.9rem 0.9rem;
      border: 1px solid #ddd;
      margin-bottom: 0.8rem;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
  </style>
</head>
<body>
  <h1>Skill-Quadrate – zwei Datenquellen</h1>

  <section>
    <h2 id="titleA">Board A (lädt ...)</h2>
    <div id="rowsA" class="rows"></div>
    <div id="errorA" class="error"></div>
  </section>

  <section>
    <h2 id="titleB">Board B (lädt ...)</h2>
    <div id="rowsB" class="rows"></div>
    <div id="errorB" class="error"></div>
  </section>

  <script>
    // Board A und Board B – je eine eigene CSV-Datei
    document.addEventListener("DOMContentLoaded", () => {
      loadBoard(TITLE;Skill Quadrate – Gruppe E;
                Research;6;#16a085
                Prototyping;7;#8e44ad
                Testing;5;#2980b9
                Dokumentation;3;#7f8c8d
                Kundenkontakt;4;#d35400);
      loadBoard(TITLE;Skill Quadrate – Gruppe D;
                UX;8;red
                HTML;5;#e34c26
                CSS;3;#264de4
                JS;10;goldenrod
                Security;4;#c0392b);
    });

    async function loadBoard(url, titleId, rowsId, errorId) {
      const titleEl = document.getElementById(titleId);
      const rowsContainer = document.getElementById(rowsId);
      const errorEl = document.getElementById(errorId);

      try {
        const res = await fetch(url);
        if (!res.ok) {
          throw new Error("Konnte " + url + " nicht laden");
        }

        const text = await res.text();
        const lines = text
          .split(/\r?\n/)
          .map(l => l.trim())
          .filter(l => l.length > 0);

        rowsContainer.innerHTML = "";
        errorEl.textContent = "";

        lines.forEach(line => {
          const delimiter = line.includes(";") ? ";" : ",";
          const parts = line.split(delimiter).map(p => p.trim());

          const col1 = parts[0] || "";
          const col2 = parts[1] || "";
          const col3 = parts[2] || "#999";

          // TITLE-Zeile
          if (col1.toLowerCase() === "title") {
            if (col2) {
              titleEl.textContent = col2;
            }
            return;
          }

          // normale Skill-Zeile: Label;Anzahl;Farbe
          if (!col1) return;

          let count = parseInt(col2, 10);
          if (isNaN(count) || count < 0) count = 0;

          const maxSquares = 30;
          if (count > maxSquares) count = maxSquares;

          addRow(rowsContainer, col1, count, col3);
        });
      } catch (err) {
        errorEl.textContent = err.message;
      }
    }

    function addRow(container, label, count, color) {
      const row = document.createElement("div");
      row.className = "row";

      const labelEl = document.createElement("div");
      labelEl.className = "label";
      labelEl.textContent = label;

      const squaresEl = document.createElement("div");
      squaresEl.className = "squares";

      for (let i = 0; i < count; i++) {
        const sq = document.createElement("div");
        sq.className = "square";
        sq.style.backgroundColor = color;
        squaresEl.appendChild(sq);
      }

      row.appendChild(labelEl);
      row.appendChild(squaresEl);
      container.appendChild(row);
    }
  </script>
</body>
</html>
